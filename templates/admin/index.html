{% extends "admin/base_site.html" %}
{% load i18n %}

{% block title %}Главная страница{% endblock %}

{% block extrahead %}
<style>
    /* Use Unfold's CSS variables for theming */
    .dashboard-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin: 20px 0;
    }
    
    .stats-card {
        background: var(--color-base-50);
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        border: 1px solid var(--color-base-200);
        transition: all 0.3s ease;
    }
    
    .dark .stats-card {
        background: var(--color-base-800);
        border: 1px solid var(--color-base-700);
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-top: 15px;
    }
    
    .stat-item {
        text-align: center;
        padding: 15px;
        border-radius: 6px;
        background: var(--color-base-100);
        border: 1px solid var(--color-base-200);
        transition: all 0.3s ease;
    }
    
    .dark .stat-item {
        background: var(--color-base-900);
        border: 1px solid var(--color-base-700);
    }
    
    .stat-value {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 5px;
    }
    
    .stat-label {
        font-size: 14px;
        color: var(--color-base-500);
    }
    
    .dark .stat-label {
        color: var(--color-base-400);
    }
    
    .progress-bar {
        width: 100%;
        height: 8px;
        background: var(--color-base-200);
        border-radius: 4px;
        overflow: hidden;
        margin-top: 10px;
    }
    
    .dark .progress-bar {
        background: var(--color-base-700);
    }
    
    .progress-fill {
        height: 100%;
        transition: width 0.3s ease;
    }
    
    .progress-green { background: #10b981; }
    .progress-yellow { background: #f59e0b; }
    .progress-red { background: #ef4444; }
    
    .text-green { color: #10b981; }
    .text-yellow { color: #f59e0b; }
    .text-red { color: #ef4444; }
    .text-black { 
        color: var(--color-base-900);
    }
    
    .dark .text-black {
        color: var(--color-base-100);
    }
    
    .daily-stats {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 15px;
        margin-top: 15px;
    }
    
    .daily-item {
        text-align: center;
        padding: 15px;
        border-radius: 6px;
        background: var(--color-base-100);
        border: 1px solid var(--color-base-200);
        transition: all 0.3s ease;
    }
    
    .dark .daily-item {
        background: var(--color-base-900);
        border: 1px solid var(--color-base-700);
    }
    
    .daily-label {
        font-size: 12px;
        color: var(--color-base-500);
        margin-bottom: 8px;
    }
    
    .dark .daily-label {
        color: var(--color-base-400);
    }
    
    .section-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        color: var(--color-base-900);
    }
    
    .dark .section-title {
        color: var(--color-base-100);
    }
    
    .last-update {
        font-size: 12px;
        color: var(--color-base-500);
        text-align: center;
        margin-top: 20px;
        font-weight: 500;
    }
    
    .dark .last-update {
        color: var(--color-base-400);
    }
    
    /* Hover effects for better UX */
    .stat-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .daily-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .dark .stat-item:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    }
    
    .dark .daily-item:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Анализ по УИК -->
    <div class="stats-card">
        <div class="section-title">Анализ по УИК</div>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value text-black">{{ analysis_total_uiks }}</div>
                <div class="stat-label">Всего УИК</div>
            </div>
            <div class="stat-item">
                <div class="stat-value text-black">{{ analysis_completed_uiks }}</div>
                <div class="stat-label">Выполнено</div>
            </div>
            <div class="stat-item">
                <div class="stat-value text-black">{{ analysis_total_planned_voters }}</div>
                <div class="stat-label">План</div>
            </div>
            <div class="stat-item">
                <div class="stat-value {% if analysis_voters_percentage >= 100 %}text-green{% elif analysis_voters_percentage >= 80 %}text-yellow{% else %}text-red{% endif %}">{{ analysis_total_confirmed_voters }}</div>
                <div class="stat-label">Факт</div>
            </div>
        </div>
        <div class="progress-bar">
            <div class="progress-fill {% if analysis_voters_percentage >= 100 %}progress-green{% elif analysis_voters_percentage >= 80 %}progress-yellow{% else %}progress-red{% endif %}" 
                 style="width: {{ analysis_voters_percentage|floatformat:0 }}%"></div>
        </div>
    </div>
    
    <!-- Результаты голосования -->
    <div class="stats-card">
        <div class="section-title">Результаты голосования</div>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value text-black">{{ results_total_plan }}</div>
                <div class="stat-label">План</div>
            </div>
            <div class="stat-item">
                <div class="stat-value {% if results_plan_execution_percent >= 100 %}text-green{% elif results_plan_execution_percent >= 80 %}text-yellow{% else %}text-red{% endif %}">{{ results_total_fact }}</div>
                <div class="stat-label">Факт</div>
            </div>
        </div>
        <div class="progress-bar">
            <div class="progress-fill {% if results_plan_execution_percent >= 100 %}progress-green{% elif results_plan_execution_percent >= 80 %}progress-yellow{% else %}progress-red{% endif %}" 
                 style="width: {{ results_plan_execution_percent|floatformat:0 }}%"></div>
        </div>
    </div>
    
    <!-- Голосование по дням -->
    <div class="stats-card" style="grid-column: 1 / -1;">
        <div class="section-title">Голосование по дням</div>
        <div class="daily-stats">
            <div class="daily-item">
                <div class="daily-label">12.09</div>
                <div class="stat-value text-black">{{ results_total_plan_12_sep }}</div>
                <div class="stat-label">План</div>
                <div class="stat-value {% if results_plan_12_percent >= 100 %}text-green{% elif results_plan_12_percent >= 80 %}text-yellow{% else %}text-red{% endif %}">{{ results_total_12_sep }}</div>
                <div class="stat-label">Факт</div>
                <div class="progress-bar">
                    <div class="progress-fill {% if results_plan_12_percent >= 100 %}progress-green{% elif results_plan_12_percent >= 80 %}progress-yellow{% else %}progress-red{% endif %}" 
                         style="width: {{ results_plan_12_percent|floatformat:0 }}%"></div>
                </div>
            </div>
            <div class="daily-item">
                <div class="daily-label">13.09</div>
                <div class="stat-value text-black">{{ results_total_plan_13_sep }}</div>
                <div class="stat-label">План</div>
                <div class="stat-value {% if results_plan_13_percent >= 100 %}text-green{% elif results_plan_13_percent >= 80 %}text-yellow{% else %}text-red{% endif %}">{{ results_total_13_sep }}</div>
                <div class="stat-label">Факт</div>
                <div class="progress-bar">
                    <div class="progress-fill {% if results_plan_13_percent >= 100 %}progress-green{% elif results_plan_13_percent >= 80 %}progress-yellow{% else %}progress-red{% endif %}" 
                         style="width: {{ results_plan_13_percent|floatformat:0 }}%"></div>
                </div>
            </div>
            <div class="daily-item">
                <div class="daily-label">14.09</div>
                <div class="stat-value text-black">{{ results_total_plan_14_sep }}</div>
                <div class="stat-label">План</div>
                <div class="stat-value {% if results_plan_14_percent >= 100 %}text-green{% elif results_plan_14_percent >= 80 %}text-yellow{% else %}text-red{% endif %}">{{ results_total_14_sep }}</div>
                <div class="stat-label">Факт</div>
                <div class="progress-bar">
                    <div class="progress-fill {% if results_plan_14_percent >= 100 %}progress-green{% elif results_plan_14_percent >= 80 %}progress-yellow{% else %}progress-red{% endif %}" 
                         style="width: {{ results_plan_14_percent|floatformat:0 }}%"></div>
                </div>
            </div>
        </div>
    </div>
</div>

{% if last_update_time %}
<div class="last-update">
    Последнее обновление: {{ last_update_time|date:"d.m.Y H:i" }}
</div>
{% endif %}
{% endblock %}